{"numFailedTestSuites":4,"numFailedTests":8,"numPassedTestSuites":9,"numPassedTests":37,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":13,"numTotalTests":45,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":1,"total":1,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1766175713482,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["Calendar API"],"duration":2,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of undefined (reading 'url')\n    at url (C:\\work\\projects\\valur_sippe\\familyhub\\app\\api\\calendar\\route.ts:7:46)\n    at Object.<anonymous> (C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\api\\calendar.test.ts:22:35)\n    at Promise.then.completed (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"Calendar API GET returns a list of events","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"GET returns a list of events"},{"ancestorTitles":["Calendar API"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"Calendar API POST adds a new event","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"POST adds a new event"},{"ancestorTitles":["Calendar API"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Calendar API PUT updates an event (stub)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"PUT updates an event (stub)"},{"ancestorTitles":["Calendar API"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Calendar API DELETE removes an event (stub)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"DELETE removes an event (stub)"}],"endTime":1766175713916,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mCalendar API › GET returns a list of events\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of undefined (reading 'url')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m  5 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m  6 |\u001b[39m \u001b[36mexport\u001b[39m \u001b[36masync\u001b[39m \u001b[36mfunction\u001b[39m \u001b[33mGET\u001b[39m(request\u001b[33m:\u001b[39m \u001b[33mNextRequest\u001b[39m) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m  7 |\u001b[39m     \u001b[36mconst\u001b[39m { searchParams } \u001b[33m=\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mURL\u001b[39m(request\u001b[33m.\u001b[39murl)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                                              \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m  8 |\u001b[39m     \u001b[36mconst\u001b[39m startParam \u001b[33m=\u001b[39m searchParams\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(\u001b[32m'start'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m  9 |\u001b[39m     \u001b[36mconst\u001b[39m endParam \u001b[33m=\u001b[39m searchParams\u001b[33m.\u001b[39m\u001b[36mget\u001b[39m(\u001b[32m'end'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 10 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat url (\u001b[22m\u001b[2mapp/api/calendar/route.ts\u001b[2m:7:46)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36m__tests__/api/calendar.test.ts\u001b[39m\u001b[0m\u001b[2m:22:35)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\api\\calendar.test.ts","startTime":1766175713522,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["HubShell Snapshot"],"duration":17,"failureDetails":[{}],"failureMessages":["Error: useFamilyHub must be used within a FamilyHubProvider\n    at useFamilyHub (C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\contexts\\FamilyHubContext.tsx:94:15)\n    at StatusRail (C:\\work\\projects\\valur_sippe\\familyhub\\src\\components\\zones\\StatusRail.tsx:9:48)\n    at Object.react_stack_bottom_frame (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:25904:20)\n    at renderWithHooks (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:7662:22)\n    at updateFunctionComponent (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:10166:19)\n    at beginWork (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:11778:18)\n    at runWithFiberInDEV (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:874:13)\n    at performUnitOfWork (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17641:22)\n    at workLoopSync (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17469:41)\n    at renderRootSync (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17450:11)\n    at performWorkOnRoot (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:16583:35)\n    at performWorkOnRootViaSchedulerTask (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:18957:7)\n    at flushActQueue (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react\\cjs\\react.development.js:590:34)\n    at Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react\\cjs\\react.development.js:884:10)\n    at C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\act-compat.js:47:25\n    at renderRoot (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\pure.js:190:26)\n    at render (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\pure.js:292:10)\n    at Object.<anonymous> (C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\snapshots\\HubShell.test.tsx:7:37)\n    at Promise.then.completed (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"HubShell Snapshot renders correctly with children","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"renders correctly with children"}],"endTime":1766175714620,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mHubShell Snapshot › renders correctly with children\u001b[39m\u001b[22m\n\n    useFamilyHub must be used within a FamilyHubProvider\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 92 |\u001b[39m     \u001b[36mconst\u001b[39m context \u001b[33m=\u001b[39m useContext(\u001b[33mFamilyHubContext\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 93 |\u001b[39m     \u001b[36mif\u001b[39m (context \u001b[33m===\u001b[39m undefined) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 94 |\u001b[39m         \u001b[36mthrow\u001b[39m \u001b[36mnew\u001b[39m \u001b[33mError\u001b[39m(\u001b[32m'useFamilyHub must be used within a FamilyHubProvider'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m               \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 95 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 96 |\u001b[39m     \u001b[36mreturn\u001b[39m context\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 97 |\u001b[39m }\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat useFamilyHub (\u001b[22m\u001b[2msrc/lib/contexts/FamilyHubContext.tsx\u001b[2m:94:15)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat StatusRail (\u001b[22m\u001b[2msrc/components/zones/StatusRail.tsx\u001b[2m:9:48)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.react_stack_bottom_frame (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:25904:20)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderWithHooks (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:7662:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat updateFunctionComponent (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:10166:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat beginWork (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:11778:18)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat runWithFiberInDEV (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:874:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performUnitOfWork (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17641:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat workLoopSync (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17469:41)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderRootSync (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17450:11)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performWorkOnRoot (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:16583:35)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performWorkOnRootViaSchedulerTask (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:18957:7)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat flushActQueue (\u001b[22m\u001b[2mnode_modules/react/cjs/react.development.js\u001b[2m:590:34)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous>.process.env.NODE_ENV.exports.act (\u001b[22m\u001b[2mnode_modules/react/cjs/react.development.js\u001b[2m:884:10)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/act-compat.js\u001b[2m:47:25\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderRoot (\u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/pure.js\u001b[2m:190:26)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat render (\u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/pure.js\u001b[2m:292:10)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36m__tests__/snapshots/HubShell.test.tsx\u001b[39m\u001b[0m\u001b[2m:7:37)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\snapshots\\HubShell.test.tsx","startTime":1766175714362,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["CalendarWidget"],"duration":3,"failureDetails":[{}],"failureMessages":["TypeError: Cannot read properties of null (reading 'length')\n    at length (C:\\work\\projects\\valur_sippe\\familyhub\\src\\components\\widgets\\CalendarWidget.tsx:10:17)\n    at Object.react_stack_bottom_frame (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:25904:20)\n    at renderWithHooks (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:7662:22)\n    at updateFunctionComponent (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:10166:19)\n    at beginWork (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:11778:18)\n    at runWithFiberInDEV (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:874:13)\n    at performUnitOfWork (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17641:22)\n    at workLoopSync (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17469:41)\n    at renderRootSync (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:17450:11)\n    at performWorkOnRoot (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:16583:35)\n    at performWorkOnRootViaSchedulerTask (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react-dom\\cjs\\react-dom-client.development.js:18957:7)\n    at flushActQueue (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react\\cjs\\react.development.js:590:34)\n    at Object.<anonymous>.process.env.NODE_ENV.exports.act (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\react\\cjs\\react.development.js:884:10)\n    at C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\act-compat.js:47:25\n    at renderRoot (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\pure.js:190:26)\n    at render (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\react\\dist\\pure.js:292:10)\n    at Object.<anonymous> (C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\widgets\\CalendarWidget.test.tsx:30:15)\n    at Promise.then.completed (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"CalendarWidget renders empty state when events is null","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"renders empty state when events is null"},{"ancestorTitles":["CalendarWidget"],"duration":15,"failureDetails":[{"name":"TestingLibraryElementError"}],"failureMessages":["TestingLibraryElementError: Unable to find an element with the text: Keine Termine. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.\n\nIgnored nodes: comments, script, style\n\u001b[36m<body>\u001b[39m\n  \u001b[36m<div>\u001b[39m\n    \u001b[36m<div\u001b[39m\n      \u001b[33mclass\u001b[39m=\u001b[32m\"opacity-60\"\u001b[39m\n    \u001b[36m>\u001b[39m\n      \u001b[0mNo upcoming events\u001b[0m\n    \u001b[36m</div>\u001b[39m\n  \u001b[36m</div>\u001b[39m\n\u001b[36m</body>\u001b[39m\n    at Object.getElementError (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\dom\\dist\\config.js:37:19)\n    at C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\dom\\dist\\query-helpers.js:76:38\n    at C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\dom\\dist\\query-helpers.js:52:17\n    at C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\@testing-library\\dom\\dist\\query-helpers.js:95:19\n    at Object.getByText (C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\widgets\\CalendarWidget.test.tsx:36:23)\n    at Promise.then.completed (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at _runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\work\\projects\\valur_sippe\\familyhub\\node_modules\\jest-runner\\build\\runTest.js:444:34)"],"fullName":"CalendarWidget renders empty state when events array is empty","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"renders empty state when events array is empty"},{"ancestorTitles":["CalendarWidget"],"duration":16,"failureDetails":[],"failureMessages":[],"fullName":"CalendarWidget renders list of events","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"renders list of events"}],"endTime":1766175714791,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mCalendarWidget › renders empty state when events is null\u001b[39m\u001b[22m\n\n    TypeError: Cannot read properties of null (reading 'length')\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m  8 |\u001b[39m     events\u001b[33m:\u001b[39m \u001b[33mCalendarEvent\u001b[39m[]\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m  9 |\u001b[39m }) {\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 10 |\u001b[39m     \u001b[36mif\u001b[39m (\u001b[33m!\u001b[39mevents\u001b[33m.\u001b[39mlength) {\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                 \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 11 |\u001b[39m         \u001b[36mreturn\u001b[39m \u001b[33m<\u001b[39m\u001b[33mdiv\u001b[39m className\u001b[33m=\u001b[39m\u001b[32m\"opacity-60\"\u001b[39m\u001b[33m>\u001b[39m\u001b[33mNo\u001b[39m upcoming events\u001b[33m<\u001b[39m\u001b[33m/\u001b[39m\u001b[33mdiv\u001b[39m\u001b[33m>\u001b[39m\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 12 |\u001b[39m     }\u001b[22m\n\u001b[2m     \u001b[90m 13 |\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat length (\u001b[22m\u001b[2msrc/components/widgets/CalendarWidget.tsx\u001b[2m:10:17)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.react_stack_bottom_frame (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:25904:20)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderWithHooks (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:7662:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat updateFunctionComponent (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:10166:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat beginWork (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:11778:18)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat runWithFiberInDEV (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:874:13)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performUnitOfWork (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17641:22)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat workLoopSync (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17469:41)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderRootSync (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:17450:11)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performWorkOnRoot (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:16583:35)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat performWorkOnRootViaSchedulerTask (\u001b[22m\u001b[2mnode_modules/react-dom/cjs/react-dom-client.development.js\u001b[2m:18957:7)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat flushActQueue (\u001b[22m\u001b[2mnode_modules/react/cjs/react.development.js\u001b[2m:590:34)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous>.process.env.NODE_ENV.exports.act (\u001b[22m\u001b[2mnode_modules/react/cjs/react.development.js\u001b[2m:884:10)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/act-compat.js\u001b[2m:47:25\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat renderRoot (\u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/pure.js\u001b[2m:190:26)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat render (\u001b[22m\u001b[2mnode_modules/@testing-library/react/dist/pure.js\u001b[2m:292:10)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36m__tests__/widgets/CalendarWidget.test.tsx\u001b[39m\u001b[0m\u001b[2m:30:15)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mCalendarWidget › renders empty state when events array is empty\u001b[39m\u001b[22m\n\n    TestingLibraryElementError: Unable to find an element with the text: Keine Termine. This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible.\n\n    Ignored nodes: comments, script, style\n    \u001b[36m<body>\u001b[39m\n      \u001b[36m<div>\u001b[39m\n        \u001b[36m<div\u001b[39m\n          \u001b[33mclass\u001b[39m=\u001b[32m\"opacity-60\"\u001b[39m\n        \u001b[36m>\u001b[39m\n          \u001b[0mNo upcoming events\u001b[0m\n        \u001b[36m</div>\u001b[39m\n      \u001b[36m</div>\u001b[39m\n    \u001b[36m</body>\u001b[39m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 34 |\u001b[39m     it(\u001b[32m'renders empty state when events array is empty'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 35 |\u001b[39m         render(\u001b[33m<\u001b[39m\u001b[33mCalendarWidget\u001b[39m events\u001b[33m=\u001b[39m{[]} \u001b[33m/\u001b[39m\u001b[33m>\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 36 |\u001b[39m         expect(screen\u001b[33m.\u001b[39mgetByText(\u001b[32m'Keine Termine'\u001b[39m))\u001b[33m.\u001b[39mtoBeInTheDocument()\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                       \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 37 |\u001b[39m     })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 38 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 39 |\u001b[39m     it(\u001b[32m'renders list of events'\u001b[39m\u001b[33m,\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getElementError (\u001b[22m\u001b[2mnode_modules/@testing-library/dom/dist/config.js\u001b[2m:37:19)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/@testing-library/dom/dist/query-helpers.js\u001b[2m:76:38\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/@testing-library/dom/dist/query-helpers.js\u001b[2m:52:17\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat \u001b[22m\u001b[2mnode_modules/@testing-library/dom/dist/query-helpers.js\u001b[2m:95:19\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.getByText (\u001b[22m\u001b[2m\u001b[0m\u001b[36m__tests__/widgets/CalendarWidget.test.tsx\u001b[39m\u001b[0m\u001b[2m:36:23)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\widgets\\CalendarWidget.test.tsx","startTime":1766175714629,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Agent Router"],"duration":3,"failureDetails":[{"matcherResult":{"actual":{"type":"chat","role":"assistant","text":"Mock Chat Response"},"expected":{"type":"chat","text":"Mock Chat Response"},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Mock Chat Response\",\u001b[22m\n\u001b[2m    \"type\": \"chat\",\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Mock Chat Response\",\u001b[22m\n\u001b[2m    \"type\": \"chat\",\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\agentRouter.test.ts:44:26)"],"fullName":"Agent Router routes smalltalk to chat orchestrator","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"routes smalltalk to chat orchestrator"},{"ancestorTitles":["Agent Router"],"duration":1,"failureDetails":[{"matcherResult":{"actual":{"type":"chat","role":"assistant","text":"Event added","actionResult":{"status":"success","summary":"Event added","payload":{}}},"expected":{"type":"chat","text":"Event added","actionResult":{"inverse":false}},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Event added\",\u001b[22m\n\u001b[2m    \"type\": \"chat\",\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Event added\",\u001b[22m\n\u001b[2m    \"type\": \"chat\",\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\agentRouter.test.ts:66:26)"],"fullName":"Agent Router routes calendar_action to calendar agent","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"routes calendar_action to calendar agent"},{"ancestorTitles":["Agent Router"],"duration":0,"failureDetails":[{"matcherResult":{"actual":{"type":"action_request","role":"assistant","text":"Confirm dentist?","actionResult":{"status":"confirmation_needed","summary":"Confirm dentist?","payload":{"title":"dentist"}},"requiresConfirmation":true},"expected":{"type":"action_request","text":"Confirm dentist?","actionResult":{"inverse":false},"requiresConfirmation":true},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[2m    \"requiresConfirmation\": true,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Confirm dentist?\",\u001b[22m\n\u001b[2m    \"type\": \"action_request\",\u001b[22m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 0\u001b[39m\n\u001b[31m+ Received  + 1\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[2m    \"requiresConfirmation\": true,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"Confirm dentist?\",\u001b[22m\n\u001b[2m    \"type\": \"action_request\",\u001b[22m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\agentRouter.test.ts:88:26)"],"fullName":"Agent Router handles confirmation_needed from calendar agent","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"handles confirmation_needed from calendar agent"},{"ancestorTitles":["Agent Router"],"duration":0,"failureDetails":[{"matcherResult":{"actual":{"type":"clarification_needed","role":"assistant","text":"What time?","actionResult":{"status":"clarification_needed","summary":"What time?","missingInfo":["time"]}},"expected":{"type":"chat","text":"What time?","actionResult":{"inverse":false}},"message":"\u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 2\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"What time?\",\u001b[22m\n\u001b[32m-   \"type\": \"chat\",\u001b[39m\n\u001b[31m+   \"type\": \"clarification_needed\",\u001b[39m\n\u001b[2m  }\u001b[22m","name":"toEqual","pass":false}}],"failureMessages":["Error: \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n\u001b[32m- Expected  - 1\u001b[39m\n\u001b[31m+ Received  + 2\u001b[39m\n\n\u001b[2m  Object {\u001b[22m\n\u001b[2m    \"actionResult\": Anything,\u001b[22m\n\u001b[31m+   \"role\": \"assistant\",\u001b[39m\n\u001b[2m    \"text\": \"What time?\",\u001b[22m\n\u001b[32m-   \"type\": \"chat\",\u001b[39m\n\u001b[31m+   \"type\": \"clarification_needed\",\u001b[39m\n\u001b[2m  }\u001b[22m\n    at Object.toEqual (C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\agentRouter.test.ts:112:26)"],"fullName":"Agent Router handles clarification_needed from calendar agent","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"handles clarification_needed from calendar agent"},{"ancestorTitles":["Agent Router"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Agent Router routes unknown intent to fallback","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"routes unknown intent to fallback"}],"endTime":1766175714891,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mAgent Router › routes smalltalk to chat orchestrator\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 0\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[31m+   \"role\": \"assistant\",\u001b[39m\n    \u001b[2m    \"text\": \"Mock Chat Response\",\u001b[22m\n    \u001b[2m    \"type\": \"chat\",\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 42 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 43 |\u001b[39m         expect(createChatResponse)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\u001b[32m'Hello'\u001b[39m\u001b[33m,\u001b[39m expect\u001b[33m.\u001b[39mobjectContaining({ contextOverride\u001b[33m:\u001b[39m mockContext }))\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 44 |\u001b[39m         expect(response)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 45 |\u001b[39m             type\u001b[33m:\u001b[39m \u001b[32m'chat'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 46 |\u001b[39m             text\u001b[33m:\u001b[39m \u001b[32m\"Mock Chat Response\"\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 47 |\u001b[39m         })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/agents/__tests__/agentRouter.test.ts\u001b[39m\u001b[0m\u001b[2m:44:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mAgent Router › routes calendar_action to calendar agent\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 0\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[2m    \"actionResult\": Anything,\u001b[22m\n    \u001b[31m+   \"role\": \"assistant\",\u001b[39m\n    \u001b[2m    \"text\": \"Event added\",\u001b[22m\n    \u001b[2m    \"type\": \"chat\",\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 64 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 65 |\u001b[39m         expect(processCalendarIntent)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(intent\u001b[33m,\u001b[39m mockContext\u001b[33m,\u001b[39m \u001b[32m'Add event'\u001b[39m)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 66 |\u001b[39m         expect(response)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 67 |\u001b[39m             type\u001b[33m:\u001b[39m \u001b[32m'chat'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 68 |\u001b[39m             text\u001b[33m:\u001b[39m \u001b[32m'Event added'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 69 |\u001b[39m             actionResult\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39manything()\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/agents/__tests__/agentRouter.test.ts\u001b[39m\u001b[0m\u001b[2m:66:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mAgent Router › handles confirmation_needed from calendar agent\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 0\u001b[39m\n    \u001b[31m+ Received  + 1\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[2m    \"actionResult\": Anything,\u001b[22m\n    \u001b[2m    \"requiresConfirmation\": true,\u001b[22m\n    \u001b[31m+   \"role\": \"assistant\",\u001b[39m\n    \u001b[2m    \"text\": \"Confirm dentist?\",\u001b[22m\n    \u001b[2m    \"type\": \"action_request\",\u001b[22m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 86 |\u001b[39m         \u001b[36mconst\u001b[39m response \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m routeIntent(intent\u001b[33m,\u001b[39m mockContext\u001b[33m,\u001b[39m intent\u001b[33m.\u001b[39mrawInput)\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 87 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 88 |\u001b[39m         expect(response)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m    |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 89 |\u001b[39m             type\u001b[33m:\u001b[39m \u001b[32m'action_request'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 90 |\u001b[39m             text\u001b[33m:\u001b[39m \u001b[32m'Confirm dentist?'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 91 |\u001b[39m             actionResult\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39manything()\u001b[33m,\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/agents/__tests__/agentRouter.test.ts\u001b[39m\u001b[0m\u001b[2m:88:26)\u001b[22m\u001b[2m\u001b[22m\n\n\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mAgent Router › handles clarification_needed from calendar agent\u001b[39m\u001b[22m\n\n    \u001b[2mexpect(\u001b[22m\u001b[31mreceived\u001b[39m\u001b[2m).\u001b[22mtoEqual\u001b[2m(\u001b[22m\u001b[32mexpected\u001b[39m\u001b[2m) // deep equality\u001b[22m\n\n    \u001b[32m- Expected  - 1\u001b[39m\n    \u001b[31m+ Received  + 2\u001b[39m\n\n    \u001b[2m  Object {\u001b[22m\n    \u001b[2m    \"actionResult\": Anything,\u001b[22m\n    \u001b[31m+   \"role\": \"assistant\",\u001b[39m\n    \u001b[2m    \"text\": \"What time?\",\u001b[22m\n    \u001b[32m-   \"type\": \"chat\",\u001b[39m\n    \u001b[31m+   \"type\": \"clarification_needed\",\u001b[39m\n    \u001b[2m  }\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 110 |\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 111 |\u001b[39m         \u001b[90m// Clarification is treated as a chat response (asking question)\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 112 |\u001b[39m         expect(response)\u001b[33m.\u001b[39mtoEqual({\u001b[22m\n\u001b[2m     \u001b[90m     |\u001b[39m                          \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 113 |\u001b[39m             type\u001b[33m:\u001b[39m \u001b[32m'chat'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 114 |\u001b[39m             text\u001b[33m:\u001b[39m \u001b[32m'What time?'\u001b[39m\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 115 |\u001b[39m             actionResult\u001b[33m:\u001b[39m expect\u001b[33m.\u001b[39manything()\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.toEqual (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/lib/agents/__tests__/agentRouter.test.ts\u001b[39m\u001b[0m\u001b[2m:112:26)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\agentRouter.test.ts","startTime":1766175714797,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Section Snapshot"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Section Snapshot renders correctly with title and children","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"renders correctly with title and children"}],"endTime":1766175715033,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\snapshots\\Section.test.tsx","startTime":1766175714900,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["WeatherWidget"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"WeatherWidget renders loading state when data is null","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"renders loading state when data is null"},{"ancestorTitles":["WeatherWidget"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"WeatherWidget renders weather data correctly when provided","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"renders weather data correctly when provided"}],"endTime":1766175715168,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\widgets\\WeatherWidget.test.tsx","startTime":1766175715040,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["CalendarActionAgent"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"CalendarActionAgent should handle \"listing\" action successfully","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should handle \"listing\" action successfully"},{"ancestorTitles":["CalendarActionAgent"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"CalendarActionAgent should return \"clarification_needed\" if create info is missing","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return \"clarification_needed\" if create info is missing"},{"ancestorTitles":["CalendarActionAgent"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"CalendarActionAgent should return \"confirmation_needed\" if create info is complete","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return \"confirmation_needed\" if create info is complete"},{"ancestorTitles":["CalendarActionAgent"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"CalendarActionAgent should handle JSON parse errors gracefully","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle JSON parse errors gracefully"}],"endTime":1766175715272,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\calendarAgent.test.ts","startTime":1766175715173,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Intent Classifier"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Intent Classifier should use deterministic rules for greetings","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should use deterministic rules for greetings"},{"ancestorTitles":["Intent Classifier"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Intent Classifier should use Mock Mode when enabled","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should use Mock Mode when enabled"},{"ancestorTitles":["Intent Classifier"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Intent Classifier should call Orchestrator with systemPromptOverride for complex inputs","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should call Orchestrator with systemPromptOverride for complex inputs"},{"ancestorTitles":["Intent Classifier"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Intent Classifier should handle JSON parsing errors by falling back to unknown","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle JSON parsing errors by falling back to unknown"},{"ancestorTitles":["Intent Classifier"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Intent Classifier should handle orchestrator failures","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle orchestrator failures"}],"endTime":1766175715363,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\lib\\ai\\intentClassifier.test.ts","startTime":1766175715280,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["chatOrchestrator"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"chatOrchestrator should route to Ollama by default","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should route to Ollama by default"},{"ancestorTitles":["chatOrchestrator"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"chatOrchestrator should fallback to OpenAI if Ollama fails","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should fallback to OpenAI if Ollama fails"},{"ancestorTitles":["chatOrchestrator"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"chatOrchestrator should throw if both providers fail","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should throw if both providers fail"},{"ancestorTitles":["chatOrchestrator"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"chatOrchestrator should use Mock data if USE_MOCK_DATA is true","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should use Mock data if USE_MOCK_DATA is true"},{"ancestorTitles":["chatOrchestrator"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"chatOrchestrator should inject context into system prompt","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should inject context into system prompt"}],"endTime":1766175715455,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\lib\\ai\\chatOrchestrator.test.ts","startTime":1766175715374,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["fetchWeather"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"fetchWeather fetches and normalizes weather data correctly","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"fetches and normalizes weather data correctly"},{"ancestorTitles":["fetchWeather"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"fetchWeather uses mock data when USE_MOCK_DATA is true","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"uses mock data when USE_MOCK_DATA is true"},{"ancestorTitles":["fetchWeather"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"fetchWeather returns mock data on API failure","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"returns mock data on API failure"}],"endTime":1766175715544,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\api\\fetchWeather.test.ts","startTime":1766175715466,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["CalendarSync"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"CalendarSync fetches events correctly using tsdav","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"fetches events correctly using tsdav"},{"ancestorTitles":["CalendarSync"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"CalendarSync uses mock data when configured","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"uses mock data when configured"}],"endTime":1766175715628,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\__tests__\\api\\calendarSync.test.ts","startTime":1766175715552,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Explain Agent"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Explain Agent should use base persona for Calm mode","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should use base persona for Calm mode"},{"ancestorTitles":["Explain Agent"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Explain Agent should use specific persona for Nerdy mode","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should use specific persona for Nerdy mode"},{"ancestorTitles":["Explain Agent"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Explain Agent should adapt to child audience hint","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should adapt to child audience hint"},{"ancestorTitles":["Explain Agent"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Explain Agent should default to general family audience if no hint","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should default to general family audience if no hint"}],"endTime":1766175715709,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\agents\\__tests__\\explainAgent.test.ts","startTime":1766175715635,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["getContextSnapshot"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should detect fixed holidays (Christmas)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should detect fixed holidays (Christmas)"},{"ancestorTitles":["getContextSnapshot"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should detect Easter-based holidays (Carrot Friday 2025 -> April 18)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should detect Easter-based holidays (Carrot Friday 2025 -> April 18)"},{"ancestorTitles":["getContextSnapshot"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should detect school holidays (Winter 2024/25)","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should detect school holidays (Winter 2024/25)"},{"ancestorTitles":["getContextSnapshot"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should detect weekends","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should detect weekends"},{"ancestorTitles":["getContextSnapshot"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should assign correct day phase","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should assign correct day phase"},{"ancestorTitles":["getContextSnapshot"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"getContextSnapshot should set calm mode at night","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should set calm mode at night"}],"endTime":1766175715788,"message":"","name":"C:\\work\\projects\\valur_sippe\\familyhub\\src\\lib\\context\\getContextSnapshot.test.ts","startTime":1766175715714,"status":"passed","summary":""}],"wasInterrupted":false}
